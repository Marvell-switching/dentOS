From 29916085c939ba30ce6a40af95bd9a7bc616862e Mon Sep 17 00:00:00 2001
From: Taras Chornyi <taras.chornyi@plvision.eu>
Date: Wed, 10 Feb 2021 16:55:01 +0200
Subject: [PATCH] net: sfp: add quirk for Finisar FTLF8536P4BCL

Finisar FTLF8536P4BCL can operate at 1000base-X and 10000base-SR, but
reports 25G & 100GBd SR in it's EEPROM.

Signed-off-by: Vadym Kochan <vadym.kochan@plvision.eu>
Signed-off-by: Taras Chornyi <taras.chornyi@plvision.eu>
---
 drivers/net/phy/sfp-bus.c | 13 +++++++++++++
 1 file changed, 13 insertions(+)

diff --git a/drivers/net/phy/sfp-bus.c b/drivers/net/phy/sfp-bus.c
index 4cf874fb5..58a836b65 100644
--- a/drivers/net/phy/sfp-bus.c
+++ b/drivers/net/phy/sfp-bus.c
@@ -55,6 +55,13 @@ static void sfp_quirk_ubnt_uf_instant(const struct sfp_eeprom_id *id,
 	phylink_set(modes, 1000baseX_Full);
 }
 
+static void sfp_quirk_finisar_25g(const struct sfp_eeprom_id *id,
+                                 unsigned long *modes)
+{
+       phylink_set(modes, 1000baseX_Full);
+       phylink_set(modes, 10000baseSR_Full);
+}
+
 static const struct sfp_quirk sfp_quirks[] = {
 	{
 		// Alcatel Lucent G-010S-P can operate at 2500base-X, but
@@ -78,6 +85,12 @@ static const struct sfp_quirk sfp_quirks[] = {
 		.vendor = "UBNT",
 		.part = "UF-INSTANT",
 		.modes = sfp_quirk_ubnt_uf_instant,
+	}, {
+               // Finisar FTLF8536P4BCL can operate at 1000base-X and 10000base-SR,
+               // but reports 25G & 100GBd SR in it's EEPROM
+               .vendor = "FINISAR CORP.",
+               .part = "FTLF8536P4BCL",
+               .modes = sfp_quirk_finisar_25g,
 	},
 };
 
-- 
2.25.1

